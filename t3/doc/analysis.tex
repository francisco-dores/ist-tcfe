\section{Theoretical Analysis}
\label{sec:analysis}

\par In this section, we will analyse our theoretical model of the AC/DC converter in terms of the DC output voltage (V_O) and the deviation from this DC value, the AC component (v_o). Our goal is to maximize the merit function given by:

\begin{equation}
M=\frac{1}{cost*(ripple(v_O)+average(v_O-12)+10^{-6}}
  \label{eq:merit}
\end{equation}
With cost given by:
\begin{equation}
M=\frac{Sum of the resistors}{1000}+\frac{Capacity}{10^{-6}}+Num_diodes*0.1
  \label{eq:cost}
\end{equation}
 
\par To maximize it we should obtain small deviations from V_O (small riplle) and obtain a V_O closer to $12V$, wich is the output voltage required. At the same time, we must reduce the cost of the circuit, by reducing the number of components and their values. 
 
\subsection{Transformer and full wave bridge rectifier}
\label{subsec:full_wave_rectifier}

\par For the first part of the circuit we used a transformer that converts the input voltage $v_S=230cos(\omega*t) V$, with $\omega=2\pi*50$, to a voltage with the same frequency and a amplitude of $230.1V$. Thus, the number of spirals for the transformer was $N=\frac{N_1}{N_2}=1.000434783$.

\par After that, we introduced a full wave rectifier circuit that converts the negative values to positive ones, so the peaks of the sinusoidal voltage appear with the double of the original frequency. Thus, the voltage that enters the envelope detector is $v_3=\abs*{230.1cos(\omega*t)}$. To do that, we use a circuit with 4 diodes (between nodes 0, 1, 2 and 3) which ensures that the output voltage is always positive, because they only conduct current in the forward active region.
\par In that way, one can reduce the ripple in the envelope detector circuit, as we will se in the next chapter.

\subsection{Envelope Detector}
\label{subsec:env}

\par The main purpose of the envelope detector is to obtain a voltage that follows the peaks of the input voltage, achieving much smaller AC components. We can distinguish 2 phases of operation, considering the ideal diode model:

\begin{itemize}
  \item When the diode is on, the envelope voltage $v_4$ is equal to $v_3$. This happens for $T_{ON}<t<T_{OFF}$, every period. 
  \item When the diode is off, it blocks the current, and the voltage in the capacitor starts discharging throuth the resistor $R_e$. The equation to compute the voltage when the diode is off is:
  \begin{equation}
v_4=230.1cos(2*\omega*T_{OFF})*e^{-\frac{t-T_{OFF}}{R_e*C}
  \label{eq:exp}
\end{equation}
\end{itemize}

 \par For computing $T_{OFF}$ we used the equation
 
  \begin{equation}
T_{OFF}=\frac{1}{2\omega}*atan(\frac{1}{2\omega*R_e*C}
  \label{eq:toff}
\end{equation}
Then we can solve the implicit equation for $T_{ON}$
\begin{equation}
v_3(T_{ON})=230.1cos(2*\omega*T_{OFF})*e^{-\frac{T_{ON}-T_{OFF}}{R_e*C}
  \label{eq:ton}
\end{equation}

\par Notice that the envelope output voltage is defined by branches. We computed the DC value of $v_4$ as $V_4=mean(v_4)$, and the ripple is the maximum deviation $ripple_envelope=max(v_4)-min(v_4)$. This ripple is reduced by doubling the frequency in the full wave bridge rectifier, because the difference between $T_{ON}$ and $T_{OFF}$ is shorter. In this table we present the values for the DC component and the ripple:

\begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Ampere [A]} \\ \hline
    \input{../mat/curr_tb0}
  \end{tabular}
  \caption{Results for the Circuit at $t<0$}
  \label{tab:tb0}
\end{table} 


